<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>gria - GitHub Repo Image API</title>
    <style>
      @font-face {
        font-family: "Monaspace Neon";
        font-style: normal;
        src: url("https://cdn.jsdelivr.net/gh/githubnext/monaspace@v1.000/fonts/webfonts/MonaspaceNeon-Regular.woff") format("woff");
      }
      :root {
        font-size: 16px;
      }
      html,
      body {
        height: 100vh;
        width: 100vw;
        min-width: 860px;
      }
      body {
        background: fixed linear-gradient(180deg, #073a67, #040b29);
        color: white;
      }
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: "Monaspace Neon", monospace;
        font-weight: 400;
      }
      input[type="text"] {
        font-size: 1rem;
        padding: 0.25rem;
        border: 2px solid rgba(255, 255, 255, 0.5);
        background: transparent;
        color: white;
        width: 13.85rem;
        border-radius: 0 !important;
        height: 1.96rem;
      }
      input[type="text"]:focus {
        outline: none;
        border-color: rgba(255, 255, 255, 1);
      }
      input[type="submit"] {
        font-size: 1rem;
        padding: 0.33rem;
        background: rgba(220, 220, 220, 1);
        color: #073a67;
        border: none;
        cursor: pointer;
        border-radius: 0 !important;
      }
      input[type="submit"]:hover {
        background: rgba(255, 255, 255, 1);
        color: #073a67;
      }
      .gria-header {
        font-size: 3rem;
        padding: 1rem;
      }
      .gria-subheader {
        font-size: 1.5rem;
        padding: 1rem;
        padding-top: 0;
      }
      .gria-icons {
        padding: 1rem;
        position: fixed;
        bottom: 0;
        left: 0;
      }
      /* .gria-icons a, .gria-icons img { */
      .gria-icons img {
        display: inline-block;
        width: 80px;
        height: 80px;
      }
      .gria-repo-form {
        padding: 1rem;
        line-height: 2.5rem;
      }
      .gria-url-prefix {
        font-size: 1rem;
        padding: 0.33rem;
        background: transparent;
        border: 2px solid rgba(255, 255, 255, 0.5);
        border-right: none;
        color: rgba(200, 200, 200, 1);
      }
      .gria-url-slash {
        padding: 0.33rem;
        background: transparent;
        border: 2px solid rgba(255, 255, 255, 0.5);
        border-left: none;
        border-right: none;
        color: rgba(200, 200, 200, 1);
      }
      .gria-preview {
        padding: 1rem;
      }
      .gria-preview-image {
        box-shadow: 0px 0px 0.75rem 0.25rem white;
      }
      .gria-copy {
        text-align: center;
        width: 814px;
        padding: 1rem;
      }
      .gria-hidden {
        display: none;
      }
      button {
        font-size: 1rem;
        padding: 0.5rem;
        background: rgba(220, 220, 220, 1);
        color: #073a67;
        border: none;
        cursor: pointer;
      }
      button:hover {
        background: rgba(255, 255, 255, 1);
        color: #073a67;
      }
    </style>
  </head>
  <body>
    <h1 class="gria-header">gria</h1>
    <h3 class="gria-subheader">GitHub Repo Image API</h3>
    <div class="gria-repo-form">
      <form onsubmit="generateImage(event);">
        <span>Enter the URL of a public GitHub repository:</span><br /><span
          class="gria-url-prefix"
          >https://github.com/</span
        ><input type="text" id="repo-owner" placeholder="ryan-willis" /><span
          class="gria-url-slash"
          >/</span
        ><input type="text" id="repo-name" placeholder="gria" /><input
          type="submit"
          value="Generate"
        />
      </form>
    </div>
    <div class="gria-preview">
      <img
        id="gria-preview-image"
        width="814"
        height="464"
        src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII="
      />
    </div>
    <div class="gria-copy gria-hidden">
      <button onclick="textCopy(0)">Copy Markdown</button>
      <button onclick="textCopy(1)">Copy Image URL</button>
    </div>
    <div class="gria-icons">
      <a href="https://github.com/ryan-willis/gria" target="_blank"
        ><img src="https://cdn.simpleicons.org/github/ffffff"
      /></a>
    </div>
    <script type="text/javascript">
      function generateImage(event) {
        const button = document.querySelector("input[type=submit]");
        event.preventDefault();
        button.value = "Generating...";
        button.disabled = true;
        const repoOwner = document
          .getElementById("repo-owner")
          .value.trim()
          .toLowerCase();
        const repoName = document
          .getElementById("repo-name")
          .value.trim()
          .toLowerCase();
        if (repoOwner.length === 0 || repoName.length === 0) {
          button.value = "Generate";
          button.disabled = false;
          alert("Please enter a valid GitHub repository owner and name.");
          return false;
        }
        const griaPreviewImage = document.getElementById("gria-preview-image");
        const src = `https://gria.smug.af/repo/${repoOwner}/${repoName}`;
        if (griaPreviewImage.src == src) {
          button.value = "Generate";
          button.disabled = false;
          return false;
        }
        griaPreviewImage.onload = function () {
          const griaCopy = document.querySelector(".gria-copy");
          griaCopy.classList.remove("gria-hidden");
          griaPreviewImage.classList.add("gria-preview-image");
          button.value = "Generate";
          button.disabled = false;
        };
        griaPreviewImage.src = src;
        return false;
      }
      function textCopy(type) {
        const repoName =
          document.getElementById("repo-name").value.trim().toLowerCase() ||
          "gria";
        const repoOwner =
          document.getElementById("repo-owner").value.trim().toLowerCase() ||
          "ryan-willis";
        const src = `https://gria.smug.af/repo/${repoOwner}/${repoName}`;
        const text = type == 0 ? `![${repoName}](${src})` : src;
        navigator.clipboard.writeText(text).then(
          function () {
            alert("Copied to clipboard!");
          },
          function () {
            alert("Failed to copy to clipboard.");
          }
        );
      }
    </script>
  </body>
</html>
